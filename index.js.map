{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/js/scrolling.js","../src/main.js"],"sourcesContent":["export { createMarkup }\n\nfunction createMarkup(arr) {\n    return arr.map(({ webformatURL, largeImageURL, tags, likes, views, comments, downloads }) =>\n        `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n            <img\n              class=\"gallery-image\"\n              src=\"${webformatURL}\"\n              alt=\"${tags}\"\n              width=\"360\"\n            />\n          </a>\n          <div class=\"thumb-block\">\n            <div class=\"block\">\n              <h2 class=\"title\">Likes</h2>\n              <p class=\"amount\">${likes}</p>\n            </div>\n            <div class=\"block\">\n              <h2 class=\"title\">Views</h2>\n              <p class=\"amount\">${views}</p>\n            </div>\n            <div class=\"block\">\n              <h2 class=\"title\">Comments</h2>\n              <p class=\"amount\">${comments}</p>\n            </div>\n            <div class=\"block\">\n              <h2 class=\"title\">Downloads</h2>\n              <p class=\"amount\">${downloads}</p>\n            </div>\n          </div>\n        </li>`)\n        .join('');\n}","import axios from \"axios\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nexport { fetchImages };\n\nconst imagesPerPage = 15; \n\nasync function fetchImages(query, pageNum) {\n    const API_KEY = '46767628-a1a0fbec2a5b02d371c47f484';\n\n    try {\n        const encodedQuery = encodeURIComponent(query);\n\n        const apiResponse = await axios.get(`https://pixabay.com/api/`, {\n            params: {\n                key: API_KEY,\n                q: encodedQuery,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                page: pageNum,\n                per_page: imagesPerPage,\n            }\n        });\n\n        \n       if (apiResponse.data && apiResponse.data.hits) {\n            const totalHits = apiResponse.data.totalHits; \n            const currentHits = apiResponse.data.hits.length; \n\n           \n            return { \n                hits: apiResponse.data.hits, \n                totalHits: totalHits, \n                currentHits: currentHits \n            };\n        } else {\n            console.error('No hits found.');\n            return { totalHits: 0, hits: [], currentHits: 0 }; \n        }\n    } catch (error) {\n        iziToast.error({\n            title: 'Error',\n            message: 'Sorry! The site is currently unavailable. Please try later!',\n        });\n        console.error('Error message:', error.message); \n        return { totalHits: 0, hits: [], currentHits: 0 }; \n    }\n}","export { scrollingTopPage }\n\nfunction scrollingTopPage() {\n    document.addEventListener('DOMContentLoaded', function () {\n        const upButton = document.querySelector('.up-btn');\n\n        if (!upButton) return;\n\n        upButton.addEventListener('click', function () {\n            window.scrollTo({\n                top: 0,\n                behavior: 'smooth'\n            });\n\n            document.body.classList.add('scrolling');\n        });\n\n        window.addEventListener('scroll', function () {\n           \n            if (window.scrollY > 200) {\n                upButton.classList.add('show');\n            } else {\n                upButton.classList.remove('show');\n            }\n\n           \n            if (document.body.classList.contains('scrolling') && window.scrollY === 0) {\n                document.body.classList.remove('scrolling');\n            }\n        });\n    });\n}\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport { createMarkup } from \"./js/render-functions\";\nimport { fetchImages } from \"./js/pixabay-api\"; \nimport { scrollingTopPage } from \"./js/scrolling\";\n\nconst searchForm = document.querySelector('.js-search');\nconst imageGallery = document.querySelector('.gallery');\nconst loadingSpinner = document.querySelector('.loader');\nconst loadMoreButton = document.querySelector('.btn-load');\nconst loadingMoreSpinner = document.querySelector('.loader-more');\nconst endOfResults = document.querySelector('.end-loader');\n\nlet currentPageNumber = 1;\nconst imagesPerPage = 15;  \nlet searchQuery = '';\nlet lightboxInstance;\n\nloadingSpinner.style.display = 'none';\nloadingMoreSpinner.style.display = 'none';\nloadMoreButton.style.display = 'none';\nendOfResults.style.display = 'none';\n\nsearchForm.addEventListener('submit', onSearchSubmit);\nloadMoreButton.addEventListener('click', onLoadMoreImages);\n\nscrollingTopPage();\n\nasync function onSearchSubmit(event) {\n    event.preventDefault();\n\n    currentPageNumber = 1;\n    imageGallery.innerHTML = '';\n    loadingSpinner.style.display = 'block';\n    loadMoreButton.style.display = 'none';\n    endOfResults.style.display = 'none';\n\n    searchQuery = event.target.elements.search.value.trim();\n\n    if (!searchQuery) {\n        iziToast.warning({\n            title: 'Caution',\n            message: 'Sorry, but you did not fill out the field!',\n        });\n        loadingSpinner.style.display = 'none';\n        return;\n    }\n\n    try {\n        const data = await fetchImages(searchQuery, currentPageNumber);\n        loadingSpinner.style.display = 'none';\n\n        if (!data || typeof data.totalHits === 'undefined' || !data.hits) {\n            iziToast.error({\n                title: 'Error',\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n            });\n            return;\n        }\n\n        const totalPages = Math.ceil(data.totalHits / imagesPerPage); \n\n        if (currentPageNumber >= totalPages) {\n            loadMoreButton.style.display = 'none';\n            endOfResults.style.display = 'block';\n        } else {\n            loadMoreButton.style.display = 'block';\n        }\n\n        if (data.hits.length === 0) {\n            iziToast.error({\n                title: 'Error',\n                message: 'Sorry, there are no images matching your search query. Please try again!',\n            });\n            return;\n        }\n\n        imageGallery.insertAdjacentHTML(\"beforeend\", createMarkup(data.hits));\n\n        iziToast.success({\n            title: 'Wow',\n            message: `We found ${data.totalHits} pictures!`,\n        });\n\n        lightboxInstance = new SimpleLightbox('.gallery a', {\n            captions: true,\n            captionsData: 'alt',\n            captionDelay: 250,\n        }).refresh();\n\n        searchForm.reset();\n    } catch (err) {\n        loadingSpinner.style.display = 'none';\n        console.error(err);\n        iziToast.error({\n            title: 'Error',\n            message: 'An unexpected error occurred. Please try again.',\n        });\n    }\n}\n\nasync function onLoadMoreImages() {\n    currentPageNumber += 1;\n\n    loadingMoreSpinner.style.display = 'block';\n    loadMoreButton.style.display = 'none';\n    endOfResults.style.display = 'none';\n\n    try {\n        const data = await fetchImages(searchQuery, currentPageNumber);\n        loadingMoreSpinner.style.display = 'none';\n\n        if (!data || typeof data.totalHits === 'undefined' || !data.hits) {\n            iziToast.error({\n                title: 'Error',\n                message: 'Sorry, no more images to load.',\n            });\n            return;\n        }\n\n        \n        imageGallery.insertAdjacentHTML(\"beforeend\", createMarkup(data.hits));\n\n        const totalPages = Math.ceil(data.totalHits / imagesPerPage); \n        if (currentPageNumber >= totalPages) {\n            iziToast.info({\n                title: 'Caution',\n                message: `You've reached the end of the collection.`,\n            });\n            loadMoreButton.style.display = 'none';\n            endOfResults.style.display = 'block';  \n        } else {\n            loadMoreButton.style.display = 'block';\n        }\n\n        const getHeightOfImageCard = () => document.querySelector('.gallery-item').getBoundingClientRect();\n        window.scrollBy({\n            top: getHeightOfImageCard().height * 2,\n            left: 0,\n            behavior: \"smooth\",\n        });\n\n        lightboxInstance.refresh();\n    } catch (error) {\n        loadingMoreSpinner.style.display = 'none';\n        iziToast.error({\n            title: 'Error',\n            message: 'An unexpected error occurred. Please try again.',\n        });\n        console.error('Error in onLoadMoreImages:', error);\n    }\n}\n\n"],"names":["createMarkup","arr","webformatURL","largeImageURL","tags","likes","views","comments","downloads","imagesPerPage","fetchImages","query","pageNum","API_KEY","encodedQuery","apiResponse","axios","totalHits","currentHits","error","iziToast","scrollingTopPage","upButton","searchForm","imageGallery","loadingSpinner","loadMoreButton","loadingMoreSpinner","endOfResults","currentPageNumber","searchQuery","lightboxInstance","onSearchSubmit","onLoadMoreImages","event","data","totalPages","SimpleLightbox","err","getHeightOfImageCard"],"mappings":"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"}